<%- include('./includes/head.ejs') %>
    <div class="min-height-300 bg-gradient-info position-absolute w-100"></div>
    <style>
        .btn {
            --bs-btn-padding-x: 0.8rem;
            --bs-btn-padding-y: 0.5rem;
        }
    </style>
    <link rel="stylesheet" href="/stylesheets/datatables.min.css">

    </head>

    <body class="g-sidenav-show  bg-gray-100" style="overflow-x: hidden;">
        <%- include('./includes/sidebar.ejs') %>
            </aside>

            <main class="main-content position-relative max-height-vh-100 h-100 border-radius-lg ">
                <!-- Navbar -->
                <%- include('./includes/navigation.ejs') %>

                    </nav>
                    <!-- End Navbar -->
                    <%if(role===0){%>
                        <div class="container">
                            <div class="row">
                                <div class="col-12">
                                    <div class="card mb-4">
                                        <div class="mt-3 mb-1 text-center pb-0">
                                            <h5>User table</h5>
                                        </div>

                                        <div class="card-body px-0 pt-0 pb-2">
                                            <div class="table-responsive p-0">
                                                <table id="table-1" class="table align-items-center mb-0">
                                                    <thead>
                                                        <tr>
                                                            <th class="text-uppercase text-xs font-weight-bolder">
                                                                User</th>
                                                            <th
                                                                class="text-center text-uppercase text-xs font-weight-bolder">
                                                                DOB</th>
                                                            <th
                                                                class="text-center text-uppercase text-xs font-weight-bolder">
                                                                Contact No</th>
                                                            <th
                                                                class="text-center text-uppercase text-xs font-weight-bolder">
                                                                City</th>
                                                            <th
                                                                class="text-center text-uppercase text-xs font-weight-bolder">
                                                                Role</th>
                                                            <th
                                                                class="text-center text-uppercase text-xs font-weight-bolder">
                                                                Action</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <% userData.forEach(user=>{%>
                                                            <tr>
                                                                <td>
                                                                    <div class="d-flex px-2 py-1">
                                                                        <div>
                                                                            <%if(user.userProfileImage){%>
                                                                                <img src="../uploads/<%=user.userProfileImage%>"
                                                                                    class="avatar avatar-sm me-3"
                                                                                    alt=" <%=user.userProfileImage%>">
                                                                                <%}else{%>
                                                                                    <img src="/images/adminUserProfile.png"
                                                                                        class="avatar avatar-sm me-3">
                                                                                    <%}%>
                                                                        </div>
                                                                        <div
                                                                            class="d-flex flex-column justify-content-center">
                                                                            <h6 class="mb-0 text-sm">
                                                                                <%=user.name%>
                                                                            </h6>
                                                                            <p class="text-xs text-secondary mb-0">
                                                                                <%=user.email%>
                                                                            </p>
                                                                        </div>
                                                                    </div>
                                                                </td>
                                                                <td>
                                                                    <p class="text-xs mb-0 text-center text-sm">
                                                                        <%=user.dob%>
                                                                    </p>
                                                                    <p class="text-xs text-secondary mb-0"></p>
                                                                </td>
                                                                <td>
                                                                    <p
                                                                        class="text-xs font-weight-bold mb-0 text-center text-sm">
                                                                        <%=user.phone_no%>
                                                                    </p>
                                                                    <p class="text-xs text-secondary mb-0"></p>
                                                                </td>
                                                                <td>
                                                                    <p
                                                                        class="text-xs font-weight-bold mb-0 text-center text-sm">
                                                                        <%=user.city%>
                                                                    </p>
                                                                    <p class="text-xs text-secondary mb-0"></p>
                                                                </td>
                                                                <td class="align-middle text-center text-sm">
                                                                    <span class="badge badge-sm bg-gradient-info">
                                                                        Admin
                                                                    </span>
                                                                </td>

                                                                <td class="align-middle text-center">
                                                                    <form method="GET" name="form">
                                                                        <input type="hidden" name="user_id" id="user_id"
                                                                            value="<%=user._id%>">
                                                                        <button type="submit"
                                                                            class="btn mt-2  font-weight-bold text-lg"
                                                                            data-bs-toggle="tooltip"
                                                                            data-bs-placement="top" title="Edit User"
                                                                            onclick="javascript:form.action='/admin/updateUser';">
                                                                            <i class="fas fa-edit text-info"></i></button>
                                                                        <button type="submit"
                                                                            class="btn mt-2  font-weight-bold text-lg"
                                                                            data-bs-toggle="tooltip"
                                                                            data-bs-placement="top" title="Delete"
                                                                            onclick="javascript:form.action='/admin/deleteUser';">
                                                                            <i class="fas fa-trash-alt text-danger"></i></button>
                                                                        <button type="submit"
                                                                            class="btn mt-2 font-weight-bold text-lg"
                                                                            data-bs-toggle="tooltip"
                                                                            data-bs-placement="top" title="Customers"
                                                                            onclick="javascript:form.action='/admin/displayCustomer';">
                                                                            <i class="fas fa-solid fa-users"
                                                                                style="color:green"></i>
                                                                        </button>
                                                                    </form>
                                                                </td>
                                                            </tr>
                                                            <%});%>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <%}else{%>
                                <!-- Customer Table -->
                                <div class="row">
                                    <div class="col-12">
                                        <div class="card mb-4">
                                            <div class="mt-3 mb-1 text-center pb-0">
                                                <h5>Customer table </h5>
                                            </div>
                                            
                                            <%if(role===1){%>
                                                <div class="row" style="text-align:right; padding-right:25px;">
                                                    <!-- <input type="text" name="user_id" id="user_id" value="<%=userId%>"> -->
                                                    <form action="addCustomer" method="GET">
                                                        <div class="col-12">
                                                            <button type="submit" class="btn bg-gradient-info"
                                                                style="width:200px;">
                                                                <i class="fas fa-wrench opacity-10">
                                                                </i>&nbsp;&nbsp; Add Customer </button>
                                                        </div>
                                                    </form>
                                                </div>
                                                <%}%>

                                                    <div class="card-body px-0 pt-0 pb-2">
                                                        <div class="table-responsive p-0">
                                                            <table id="table-1" class="table align-items-center mb-0">
                                                                <thead>
                                                                    <tr>
                                                                        <th
                                                                            class="text-uppercase text-xs font-weight-bolder">
                                                                            User</th>
                                                                        <th
                                                                            class="text-center text-uppercase text-xs font-weight-bolder">
                                                                            DOB</th>
                                                                        <th
                                                                            class="text-center text-uppercase text-xs font-weight-bolder">
                                                                            Contact No</th>
                                                                        <th
                                                                            class="text-center text-uppercase text-xs font-weight-bolder">
                                                                            City</th>
                                                                        <th
                                                                            class="text-center text-uppercase text-xs font-weight-bolder">
                                                                            Role</th>
                                                                        <th
                                                                            class="text-center text-uppercase text-xs font-weight-bolder">
                                                                            Action</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>

                                                                    <%customerData.forEach(customer=>{%>
                                                                        <%if(customer.role===2){%>

                                                                            <tr>
                                                                                <td>
                                                                                    <div class="d-flex px-2 py-1">
                                                                                        <div>
                                                                                            <%if(customer.userProfileImage){%>
                                                                                                <img src="../uploads/<%=customer.userProfileImage%>"
                                                                                                    class="avatar avatar-sm me-3"
                                                                                                    alt=" <%=customer.userProfileImage%>">
                                                                                                <%}else{%>
                                                                                                    <img src="/images/adminUserProfile.png"
                                                                                                        class="avatar avatar-sm me-3">
                                                                                                    <%}%>
                                                                                        </div>
                                                                                        <div
                                                                                            class="d-flex flex-column justify-content-center">
                                                                                            <h6 class="mb-0 text-sm">
                                                                                                <%=customer.name%>
                                                                                            </h6>
                                                                                            <p
                                                                                                class="text-xs text-secondary mb-0">
                                                                                                <%=customer.email%>
                                                                                            </p>
                                                                                        </div>
                                                                                    </div>
                                                                                </td>
                                                                                <td>
                                                                                    <p
                                                                                        class="text-xs mb-0 text-center text-sm">
                                                                                        <%=customer.dob%>
                                                                                    </p>
                                                                                    <p
                                                                                        class="text-xs text-secondary mb-0">
                                                                                    </p>
                                                                                </td>
                                                                                <td>
                                                                                    <p
                                                                                        class="text-xs font-weight-bold mb-0 text-center text-sm">
                                                                                        <%=customer.phone_no%>
                                                                                    </p>
                                                                                    <p
                                                                                        class="text-xs text-secondary mb-0">
                                                                                    </p>
                                                                                </td>
                                                                                <td>
                                                                                    <p
                                                                                        class="text-xs font-weight-bold mb-0 text-center text-sm">
                                                                                        <%=customer.city%>
                                                                                    </p>
                                                                                    <p
                                                                                        class="text-xs text-secondary mb-0">
                                                                                    </p>
                                                                                </td>
                                                                                <td
                                                                                    class="align-middle text-center text-sm">
                                                                                    <span
                                                                                        class="badge badge-sm bg-gradient-warning">
                                                                                        Customer
                                                                                    </span>
                                                                                </td>

                                                                                <td class="align-middle text-center">
                                                                                    <form method="GET" name="form">
                                                                                        <input type="hidden"
                                                                                            name="cust_id" id="cust_id"
                                                                                            value="<%=customer._id%>">
                                                                                        <input type="hidden"
                                                                                            name="editMode"
                                                                                            value="true">
                                                                                        <button type="submit"
                                                                                            class="btn mt-2 font-weight-bold text-lg"
                                                                                            data-bs-toggle="tooltip"
                                                                                            data-bs-placement="top"
                                                                                            title="Edit"
                                                                                            onclick="javascript:form.action='/admin/updateCustomer';">
                                                                                            <i
                                                                                                class="fas fa-edit text-info"></i></a>
                                                                                        </button>
                                                                                        <button type="submit"
                                                                                            class="btn mt-2 font-weight-bold text-lg"
                                                                                            data-bs-toggle="tooltip"
                                                                                            data-bs-placement="top"
                                                                                            title="Delete"
                                                                                            onclick="javascript:form.action='/admin/deleteCustomer';">
                                                                                            <i
                                                                                                class="fas fa-trash-alt text-danger"></i>
                                                                                        </button>
                                                                                        <button type="submit"
                                                                                            class="btn mt-2 font-weight-bold text-lg"
                                                                                            data-bs-toggle="tooltip"
                                                                                            data-bs-placement="top"
                                                                                            title="Services"
                                                                                            onclick="javascript:form.action='/admin/displayServices';">
                                                                                            <i class="fas fa-wrench"
                                                                                                style="color:green ;"></i>
                                                                                        </button>
                                                                                    </form>
                                                                                </td>
                                                                            </tr>
                                                                            <%}%>
                                                                                <%});%>
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                        </div>
                                    </div>
                                </div>
                                <%}%>
                        </div>

                        <!-- General JS Scripts -->
                        <script src="/javascripts/page/app.min.js"></script>
                        <!-- JS Libraies -->
                        <script src="/javascripts/page/datatables.min.js"></script>
                        <!-- Page Specific JS File -->
                        <script src="/javascripts/page/datatables.js"></script>
                        <!-- Template JS File -->
                        <script src="/javascripts/page/scripts.js"></script>

                        <%- include('./includes/end.ejs') %>